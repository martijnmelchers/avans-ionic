<ion-content>
    <video #playerEl class="video-js" controls style="max-width:100vw" data-setup='{}'>
        <!--<source #sourceEl id="video" src="http://localhost:5000/stream" type="video/mp4">-->
    </video>
    <ion-item color="none" lines="none" *ngIf="!playerReady">
        <ion-spinner slot="start">

        </ion-spinner>
        <ion-label>

            Loading player...
        </ion-label>
    </ion-item>
    <ion-grid>
        <ion-row>
            <ion-col size="12">

                <ion-card>
                    <ion-card-header>
                        <ion-card-title>Options</ion-card-title>
                        <ion-card-subtitle>Control the player using the buttons below</ion-card-subtitle>
                    </ion-card-header>
                    <ion-card-content>
                        <ion-item lines="none" color="none" [detail]="false" class="ion-item-full">
                            <ion-checkbox slot="start" (ionChange)="updateReadyState($event)"
                                          [checked]="ready"></ion-checkbox>
                            <ion-label>Ready</ion-label>
                        </ion-item>
                        <ion-grid>
                            <ion-row>
                                <ion-col>
                                    <ion-button size="small" (click)="player.play()">
                                        <ion-icon name="play"></ion-icon>
                                    </ion-button>
                                </ion-col>
                                <ion-col>
                                    <ion-button size="small">
                                        <ion-icon name="volume-low"></ion-icon>
                                    </ion-button>
                                </ion-col>
                                <ion-col>
                                    <ion-button size="small">
                                        <ion-icon name="volume-high"></ion-icon>
                                    </ion-button>
                                </ion-col>
                                <ion-col>
                                    <ion-button size="small">
                                        <ion-icon name="volume-mute"></ion-icon>
                                    </ion-button>
                                </ion-col>
                                <ion-col>
                                    <ion-button size="small">
                                        <ion-icon name="volume-mute"></ion-icon>
                                    </ion-button>
                                </ion-col>
                            </ion-row>
                        </ion-grid>


                        <p>Speed: {{speed}}mb/s</p>

                        <p>Peers: {{peers}}</p>
                        <ion-progress-bar [value]="progress" [buffer]="progress"
                                          [color]="progress == 1 ? 'success' : 'primary'"></ion-progress-bar>

                    </ion-card-content>

                </ion-card>
            </ion-col>
        </ion-row>

    </ion-grid>

    <ion-grid *ngIf="room">
        <ion-row>
            <ion-col size="12">
                <ion-card>
                    <ion-card-header>
                        <ion-card-title>Queue</ion-card-title>
                        <ion-card-subtitle>Click a queue item to display details</ion-card-subtitle>
                    </ion-card-header>
                    <ion-card-content>

                        <ion-list>
                            <ion-item class="ion-item-full" button lines="none">
                                <ion-label>
                                    Iron Man (2012)
                                </ion-label>
                            </ion-item>
                            <ion-progress-bar [value]=".66" [buffer]=".75"
                                              [color]="progress == 1 ? 'success' : 'secondary'"></ion-progress-bar>
                            <ion-item class="ion-item-full" button lines="none">
                                <ion-label>
                                    End Game (2019)
                                </ion-label>
                            </ion-item>
                            <ion-progress-bar [value]=".33" [buffer]=".45"
                                              [color]="progress == 1 ? 'success' : 'secondary'"></ion-progress-bar>
                            <ion-item class="ion-item-full" button lines="none">
                                <ion-label>
                                    Pulp Fiction (1994)
                                </ion-label>
                            </ion-item>
                            <ion-progress-bar [value]=".05" [buffer]=".11"
                                              [color]="progress == 1 ? 'success' : 'secondary'"></ion-progress-bar>
                        </ion-list>
                    </ion-card-content>
                </ion-card>

            </ion-col>
        </ion-row>

        <ion-row>
            <ion-col size="12">
                <ion-card>
                    <ion-card-header>
                        <ion-card-title>Users</ion-card-title>
                        <ion-card-subtitle>Click a user to display details</ion-card-subtitle>
                    </ion-card-header>
                    <ion-card-content>
                        <ion-item *ngFor="let roomUser of room.Users" button="true" class="ion-item-full"
                                  (click)="presentModal(roomUser.User.email)">
                            <ion-label class="ion-text-wrap">
                                {{roomUser.User.email}}
                                <ion-icon name="shield-checkmark-outline"
                                          *ngIf="roomUser.User._id == room.Owner"></ion-icon>
                            </ion-label>

                            <ion-icon name="checkmark" color="success"
                                      *ngIf="readyUsers.includes(roomUser.User._id)"></ion-icon>
                            <ion-icon name="close" color="danger"
                                      *ngIf="!readyUsers.includes(roomUser.User._id)"></ion-icon>

                            <ion-chip color="success" slot="end" button="false"
                                      *ngIf="onlineUsers.includes(roomUser.User._id)">
                                <ion-label>Online</ion-label>
                            </ion-chip>
                            <ion-chip color="danger" slot="end" button="false"
                                      *ngIf="!onlineUsers.includes(roomUser.User._id)">
                                <ion-label>Offline</ion-label>
                            </ion-chip>
                        </ion-item>
                    </ion-card-content>
                </ion-card>
            </ion-col>
        </ion-row>

        <ion-row>
            <ion-col size="12">
                <ion-card>
                    <ion-card-header>
                        Room settings
                    </ion-card-header>
                    <ion-card-content>
                        Wait for everyone ready
                    </ion-card-content>
                </ion-card>
            </ion-col>
        </ion-row>
        <ion-row>
            <ion-col>
                <ion-button expand="block" color="danger" fill="outline" *ngIf="auth.userId == room.Owner"
                            (click)="deleteRoom()">
                    Delete room
                </ion-button>
                <ion-button expand="block" color="danger" fill="outline" *ngIf="auth.userId != room.Owner"
                            (click)="leaveRoom()">
                    Leave room
                </ion-button>
            </ion-col>
            <ion-col>
                <ion-button expand="block" routerLink="/">
                    Back
                </ion-button>
            </ion-col>
        </ion-row>
    </ion-grid>


</ion-content>
